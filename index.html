<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Queer Journal</title>

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#d53369" />

  <!-- Ikoner -->
  <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
  <link rel="icon" sizes="32x32" href="./favicon-32x32.png" />
  <link rel="icon" sizes="16x16" href="./favicon-16x16.png" />

  <!-- Font & CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <script>
    /* Städa gammalt PIN-lås från äldre versioner */
    try { ['qj.pin','qj.salt','qj.attempts'].forEach(k => localStorage.removeItem(k)); } catch {}
  </script>

  <header>
    <h1>🌈 Queer Journal</h1>
    <div class="actions">
      <div class="user-chip" id="userChip" style="display:none">
        <img id="userPhoto" alt="">
        <small id="userName"></small>
      </div>
      <button id="logoutTop" class="toggle-dark" title="Logga ut" style="display:none">🚪</button>
      <button id="darkToggle" class="toggle-dark" title="Byt tema">🌓</button>
    </div>
  </header>

  <main>
    <!-- AUTH -->
    <section id="authSection" class="card">
      <h2>Logga in / Skapa konto</h2>
      <input id="emailInput" type="email" placeholder="E-post" />
      <input id="passwordInput" type="password" placeholder="Lösenord" />
      <div class="row">
        <button id="resetBtn" class="pill secondary">Glömt lösenord</button>
        <button id="loginBtn" class="pill">Logga in</button>
        <button id="registerBtn" class="pill secondary">Skapa konto</button>
        <button id="googleBtn" class="pill gbtn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt=""> Google
        </button>
        <button id="logoutBtn" class="pill" style="display:none">Logga ut</button>
      </div>
    </section>

    <!-- NY ANTECKNING -->
    <section id="noteSection" class="card" style="display:none">
      <h2>Ny anteckning</h2>

      <div class="row">
        <label style="flex:1">Datum
          <input id="dateInput" type="date" />
        </label>
        <label style="flex:1">Tid
          <input id="timeInput" type="time" />
        </label>
      </div>

      <label><input id="alarmCheck" type="checkbox" /> ⏰ Ställ alarm</label>

      <div class="row">
        <label style="flex:1">Känsla
          <select id="moodInput">
            <option value="">--</option>
            <option>😊 Glad</option>
            <option>🔥 Taggad</option>
            <option>😢 Ledsen</option>
            <option>🌈 Stolt</option>
          </select>
        </label>

        <label style="flex:1">Taggar
          <input id="tagsInput" type="text" placeholder="t.ex. skola, katt" />
        </label>
      </div>

      <label>Innehåll
        <textarea id="contentInput" placeholder="t.ex. 1/2 påse blötmat"></textarea>
      </label>

      <div class="row" style="align-items:center">
        <label style="flex:1">Bild (valfritt)
          <input id="imageInput" type="file" accept="image/*" />
        </label>

        <!-- Community-delning -->
        <label style="display:inline-flex; align-items:center; gap:.5rem; margin-top:.5rem">
          <input id="publicCheck" type="checkbox">
          🌍 Dela i community
        </label>
      </div>

      <div class="row" style="margin-top:.6rem">
        <button id="saveBtn" class="pill">Spara</button>
        <button id="clearBtn" class="pill secondary">Rensa</button>
      </div>
    </section>

    <!-- MINA ANTECKNINGAR -->
    <section id="notesSection" class="card" style="display:none">
      <h2>Mina anteckningar</h2>
      <div id="notesList" class="empty">Inga anteckningar ännu.</div>
    </section>

    <!-- COMMUNITY -->
    <section id="communitySection" class="card" style="display:none">
      <h2>Community</h2>
      <div id="communityList" class="empty">Inga delade inlägg ännu.</div>
    </section>
  </main>

  <footer>
    <div class="tabs">
      <button id="listViewBtn"  class="tab active">Lista</button>
      <button id="dayViewBtn"   class="tab">Dag</button>
      <button id="weekViewBtn"  class="tab">Vecka</button>
      <button id="alarmViewBtn" class="tab">Alarm</button>
      <button id="communityViewBtn" class="tab">Community</button>
    </div>
    <p>
      <a href="TERMS.md">Användarvillkor</a> ·
      <a href="PRIVACY.md">Integritetspolicy</a> ·
      <a href="COOKIES.md">Cookiepolicy</a>
    </p>
    <p>© 2025 Queer Journal</p>
  </footer>

  <!-- Alarm-ljud -->
  <audio id="alarmSound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" preload="auto"></audio>

  <!-- App-logik -->
  <script type="module" src="./app.js"></script>
</body>
<!-- Cookiebanner -->
<div id="cookie-banner" 
     style="position:fixed;bottom:0;left:0;right:0;
            background:#222;color:#fff;
            padding:10px;text-align:center;
            display:none;z-index:9999">
  Vi använder cookies för att förbättra din upplevelse.
  <a href="COOKIES.md" style="color:#4ecdc4">Läs mer</a>
  <button onclick="acceptCookies()" style="margin-left:10px">OK</button>
</div>

<script>
function acceptCookies(){
  localStorage.setItem("cookiesAccepted","true");
  document.getElementById("cookie-banner").style.display="none";
}
window.addEventListener("load", ()=>{
  if(!localStorage.getItem("cookiesAccepted")){
    document.getElementById("cookie-banner").style.display="block";
  }
});
</script>
</div>
</html>
